# –û—Ç—á—ë—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ (–û–∫–∞–∑–∞–ª–æ—Å—å –¥–µ–ª–∞–ª –Ω–µ —Ç–æ, —Å–º –æ—Ç—á–µ—Ç –Ω–∏–∂–µ)

## –ó–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ç–µ–∫—Ü–∏–∏)

**–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏:**
–û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–¥–∞—á–µ–π –±—ã–ª–æ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–¥–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (–¥–µ—Ç–µ–∫—Ü–∏—è), –Ω–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Ö —Ç–∏–ø (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è). –ú–æ–¥–µ–ª—å YOLO OBB —Ä–µ—à–∞–µ—Ç –æ–±–µ –∑–∞–¥–∞—á–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ: –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (OBB, "–≥—Ä—É–±–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∑–æ–Ω–∞") –≤–æ–∫—Ä—É–≥ –æ–±—ä–µ–∫—Ç–∞ –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç —ç—Ç–æ–π –∑–æ–Ω–µ –º–µ—Ç–∫—É –∫–ª–∞—Å—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'ean13', 'qr', 'c39'). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏.

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**
–ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –∫–∞–∫ —Ç–æ—á–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ (IoU - Intersection over Union), —Ç–∞–∫ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞:
- **mAP (mean Average Precision):** –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –æ–±—â–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏. mAP50 —É—á–∏—Ç—ã–≤–∞–µ—Ç –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å IoU > 0.5, –∞ mAP50-95 —É—Å—Ä–µ–¥–Ω—è–µ—Ç –ø–æ –ø–æ—Ä–æ–≥–∞–º IoU –æ—Ç 0.5 –¥–æ 0.95. –ß–µ–º –≤—ã—à–µ mAP, —Ç–µ–º –ª—É—á—à–µ –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –æ–±—ä–µ–∫—Ç—ã –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Ö –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç.
- **Precision (–¢–æ—á–Ω–æ—Å—Ç—å):** –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–π, —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—å—é. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –¥–æ–≤–µ—Ä—è—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º –º–æ–¥–µ–ª–∏.
- **Recall (–ü–æ–ª–Ω–æ—Ç–∞):** –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Ä–µ–∞–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–∞–∑–º–µ—Ç–∫–µ. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Ü–µ–ª–µ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã.
- **–û—Ç—á–µ—Ç –æ–± –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤, –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—å—é –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ, —á—Ç–æ –¥–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫–∏–µ —Ç–∏–ø—ã –∫–æ–¥–æ–≤ –º–æ–¥–µ–ª—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç.

**–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å YOLO OBB –¥–æ—Å—Ç–∏–≥–ª–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π mAP50(B) = 0.58 –∏ mAP50-95(B) = 0.53 –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ. –¢–æ—á–Ω–æ—Å—Ç—å (Precision) —Å–æ—Å—Ç–∞–≤–∏–ª–∞ 0.66, –∞ –ø–æ–ª–Ω–æ—Ç–∞ (Recall) - 0.54. –ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –º–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ 83 –æ–±—ä–µ–∫—Ç–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ (UPC, c128, c39, dm, ean13, pdf, qr).

**–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
1.  **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∫–ª–∞—Å—Å–æ–≤ —Å –º–µ–Ω—å—à–∏–º —á–∏—Å–ª–æ–º –æ–±—Ä–∞–∑—Ü–æ–≤, –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π (–ø–æ–≤–æ—Ä–æ—Ç—ã, –∏—Å–∫–∞–∂–µ–Ω–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è —è—Ä–∫–æ—Å—Ç–∏/–∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞) –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.
2.  **–¢—é–Ω–∏–Ω–≥ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** –ü–æ–¥–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—É—á–µ–Ω–∏—è (—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è, –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞) –º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –∏—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏.

## üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ê–Ω–∞–ª–∏–∑ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥–µ—Ç–µ–∫—Ü–∏–∏
- –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏:
  [mipt2025s-5-modern-cv/detector](https://github.com/dvpsun/mipt2025s-5-modern-cv/tree/main/detector)
- –ò–∑—É—á–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
  - –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 2. –°–æ–∑–¥–∞–Ω–∏–µ Docker-–æ–±—Ä–∞–∑–æ–≤
–°–æ–∑–¥–∞–Ω—ã 2 –¥–æ–∫–µ—Ä-–æ–±—Ä–∞–∑–∞ –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã
| –û–±—Ä–∞–∑ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|-------|------------|-------------|
| **notebook-image** | –î–ª—è —Ä–∞–±–æ—Ç—ã —Å .ipynb —Ç–µ—Ç—Ä–∞–¥–∫–∞–º–∏ | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Jupyter Lab, CUDA |
| **barcode_detector_classifier-image** | –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è .py —Å–∫—Ä–∏–ø—Ç–æ–≤ | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è production, CUDA |

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏
- –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —Å–∫—Ä–∏–ø—Ç (`raw_to_yolo.py`) –¥–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
- –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞:
    - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –æ–±—ä–µ–∫—Ç–æ–≤ (—Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –≤–µ—Ä—à–∏–Ω) –∏–∑ JSON –≤ —Ñ–æ—Ä–º–∞—Ç YOLO OBB (.txt).
    - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ç–æ—á–µ–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
    - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è –∫–ª–∞—Å—Å–æ–≤ (`class_dict.json`) –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–º–µ–Ω –∏ ID.
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ train/val —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤.

### 4. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–æ–±—É—á–µ–Ω–∏–µ –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å)
- –°–æ–∑–¥–∞–Ω –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç (`detector_classifier_script.py`) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–∏–∫–ª–æ–º —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—å—é YOLO OBB.
- –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç–∞:
    - **–û–±—É—á–µ–Ω–∏–µ:** –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —Å –Ω—É–ª—è –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ª—É—á—à–∏—Ö –≤–µ—Å–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞ (`best.pt`).
    - **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (mAP, Precision, Recall) –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `validation_metrics.json`.
    - **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫ —Ç–µ—Å—Ç–æ–≤—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ (OBB), –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, –∫–ª–∞—Å—Å–æ–≤ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏.
    - **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:** –ó–∞–ø–∏—Å—å –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–µ—Ç–µ–∫—Ü–∏–∏ (`detection_results.json`) –∏ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ (`detected_objects_report.txt`). –í—ã–¥–∞–µ—Ç—Å—è, –∫–ª–∞—Å—Å, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫–ª–∞—Å—Å–µ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ 4–µ—Ö —É–≥–æ–ª—å–Ω–∏–∫–∞.

### 5. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ YOLO OBB
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤:
  [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](https://github.com/dvpsun/mipt2025s-5-modern-cv/tree/main/runs/obb/)
- **–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ**:
  ```json
  {
      "mAP50 (Box)": 0.5823545212019611,
      "mAP50-95 (Box)": 0.5269496377908538,
      "precision (Box)": 0.6602565518823351,
      "recall (Box)": 0.5406482731044134
  }
  ```
- **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è (–∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞) –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ**:
  ```text
  –û—Ç—á–µ—Ç –æ–± –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ:
  ==================================================
  –ö–ª–∞—Å—Å: UPC                  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 1
  –ö–ª–∞—Å—Å: c128                 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 1
  –ö–ª–∞—Å—Å: c39                  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 3
  –ö–ª–∞—Å—Å: dm                   | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 44
  –ö–ª–∞—Å—Å: ean13                | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 8
  –ö–ª–∞—Å—Å: pdf                  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 21
  –ö–ª–∞—Å—Å: qr                   | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 1
  –ö–ª–∞—Å—Å: –°39                  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 4
  ==================================================
  –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 40
  –í—Å–µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–±—ä–µ–∫—Ç–æ–≤: 83
  ```


# –û—Ç—á—ë—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ: –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≥—Ä—É–±–æ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤

## –ó–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
**–¶–µ–ª—å:**  
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≥—Ä—É–±–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–æ–Ω –Ω–∞ –¥–≤–∞ —É—Ä–æ–≤–Ω—è:
1. **Main class** (1d, 2d, hard_to_detect)
2. **Sub class** (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã: ean13, qr, dm, hard_to_detect –∏ –¥—Ä.)

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞
1. **Accuracy** - –æ–±—â–∞—è –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
2. **F1-score** - –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É precision –∏ recall
3. **Class-wise metrics** - –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É
4. **–°–≤–æ–¥–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

## –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥—É–ª—è
1. –°–∫—Ä–∏–ø—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤, –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏
2. –°—ã—Ä—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã, —Å–∫–∞—á–∞–Ω–Ω—ã–µ —Å –ø–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
3. –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ Json —Ñ–∞–π–ª—ã —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π
4. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö png, jpg, tiff, tif

## –î–∞—Ç–∞—Å–µ—Ç—ã
| –ù–∞–±–æ—Ä       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ  | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                          |
|-------------|-------------|--------------------------------------|
| BarBeR      | Train       | 8000+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, 18 –∫–ª–∞—Å—Å–æ–≤        |
| ZVZ-real    | Validation  | 900+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, 18 –∫–ª–∞—Å—Å–æ–≤  |
| Our Parsed  | Test        | 140+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, 12 –∫–ª–∞—Å—Å–æ–≤   |

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É
#### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ `main_class`

| –ö–ª–∞—Å—Å     | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ |
| :-------- | :------------------ |
| 1d        | 7172                |
| 2d         | 1945                |
| out_of_test_data | 700                 |
| **–í—Å–µ–≥–æ** | **9817**            |

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ `sub_class`

| –ö–ª–∞—Å—Å           | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ |
| :-------------- | :------------------ |
| ean13           | 5023                |
| c128            | 1511                |
| qr              | 1371                |
| garbage         | 620                 |
| UPC             | 323                 |
| c39             | 202                 |
| pdf             | 194                 |
| royalmailcode   | 192                 |
| dm              | 146                 |
| I2O5            | 75                  |
| ean8            | 68                  |
| az              | 42                  |
| japanpost       | 25                  |
| kix             | 8                   |
| postnet         | 7                   |
| digit           | 3                   |
| iata25          | 3                   |
| -1              | 2                   |
| intelligentmail | 2                   |
| **–í—Å–µ–≥–æ**       | **9817**            |

### –ò—Ç–æ–≥–∏

*   **–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö `main_class`:** 3
*   **–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö `sub_class`:** 19
*   **–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π:** 9817

---

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞**  
## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –±—ã–ª–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã 3 —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
–ö–∞–∂–¥—ã–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–≤–æ–∏–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1) –ü—Ä–∏–≤–æ–¥–∏—Ç –≤—Å—é —Ä–∞–∑–º–µ—Ç–∫—É –∫ –æ–±—â–µ–º—É –≤–∏–¥—É
  ```json
  {
    "image_width": 1280,
    "image_height": 544,
    "pages": {
        "0001": [
            {
                "main_class": "1d",
                "sub_class": "ean13",
                "coordinates": [
                    [
                        323,
                        140
                    ],
                    [
                        895,
                        94
                    ],
                    [
                        909,
                        312
                    ],
                    [
                        344,
                        363
                    ]
                ]
            }
        ]
    }
    }
  ```
  2) –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è, –∏–º–µ–Ω–∞ —Å–æ–≤–ø–¥–∞—é—Ç —Å –∏–º–µ–Ω–∞–º–∏ –≤ —Ä–∞–∑–º–µ—Ç–∫–µ, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –≤—Å–µ –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –≤–∏–¥—É: "ean8", "ean13", "ean128", "UPC", "itf", "C39", "C128", "dm", "az", "qr", "pdf", "m-qr", "hard_to_detect".

  3) –†–∞–∑–º–µ—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è "1d", "2d", "hard_to_detect"

  –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤:
  [BarBer parser](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/classifier/BarBeR_parser.py)
  [ZVZ-real parser](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/classifier/ZVZ_real_parser.py)
  [Our dataset parser](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/classifier/our_dataset_parser.py)

## 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
[–°–∫—Ä–∏–ø—Ç](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/classifier/data_preparation_and_train.py) —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–¥–µ–ª–∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –æ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ –æ–±—É—á–µ–Ω–∏—è, –æ—Ü–µ–Ω–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏.

1.  **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**:
    *   –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∏—Ö JSON-–∞–Ω–Ω–æ—Ç–∞—Ü–∏–π, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∑–æ–Ω –∏ –º–µ—Ç–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ/–ø–æ–¥–∫–ª–∞—Å—Å–∞.
    *   –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ `Dataset` (`BarcodeZoneDataset`), –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–æ–Ω—ã –±–∞—Ä–∫–æ–¥–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
    *   –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π: –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ (—Å–ª—É—á–∞–π–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞, –æ—Ç—Ä–∞–∂–µ–Ω–∏—è, —Ü–≤–µ—Ç–æ–≤—ã–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è, –ø–æ–≤–æ—Ä–æ—Ç—ã) –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –Ω–∞–±–æ—Ä–æ–≤, –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ —Ä–∞–∑–º–µ—Ä—É 512x512.
    *   –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ `DataLoader`'–æ–≤.

2.  **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ (`HierarchicalBarcodeClassifier`)**:
    *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –Ω–∞ ImageNet-1K —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π —Å–µ—Ç–∏ (ResNet50 –∏–∑ torchvision.models) –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
    *   –î–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ "–≥–æ–ª–æ–≤—ã" (–ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–ª–æ–∏), –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫ –±–∞–∑–æ–≤–æ–π —Å–µ—Ç–∏: –æ–¥–Ω–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞, –¥—Ä—É–≥–∞—è ‚Äì –¥–ª—è –ø–æ–¥–∫–ª–∞—Å—Å–∞.

3.  **–ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
    *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `CrossEntropyLoss` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ AdamW.
    *   –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è (`ReduceLROnPlateau`). 
    *   –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º –ø–æ—Ç–µ—Ä—å –∏ –º–µ—Ç—Ä–∏–∫ (accuracy, precision, recall, F1-score) –∫–∞–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ, —Ç–∞–∫ –∏ –¥–ª—è –ø–æ–¥–∫–ª–∞—Å—Å–∞ –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö.
    *   –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏, –ø–æ–∫–∞–∑–∞–≤—à–µ–π –Ω–∞–∏–ª—É—á—à–∏–π Loss –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ.
    *   –í—ã–≤–æ–¥ –æ—Ç—á–µ—Ç–æ–≤ –æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`classification_report`).

4.  **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**:
    *   –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è (–¥–∏–Ω–∞–º–∏–∫–∞ –ø–æ—Ç–µ—Ä—å –∏ –º–µ—Ç—Ä–∏–∫ –ø–æ —ç–ø–æ—Ö–∞–º) —Å –ø–æ–º–æ—â—å—é `matplotlib`.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
**–û—Å–Ω–æ–≤–∞:** ResNet50 (–ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ ImageNet-1K –≤–∑—è—Ç–∞—è –∏–∑ torchvision)  
**–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- –ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ —Å–ª–æ–∏ –¥–æ 4-–≥–æ –±–ª–æ–∫–∞
- –î–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ "–≥–æ–ª–æ–≤—ã" –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
  - **Main head**: 3 –∫–ª–∞—Å—Å–∞ (1d, 2d, hard_to_detect)
  - **Sub head**: 12 –∫–ª–∞—Å—Å–æ–≤ (ean13, qr, dm –∏ –¥—Ä. + hard_to_detect)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- Loss: CrossEntropy –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: AdamW (lr=1e-4, weight_decay=1e-3)
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫: ReduceLROnPlateau (patience=3)

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
*   –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
*   –ü–∞–ø–∫–∞ —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π –≤ –≤–∏–¥–µ json —Ñ–∞–π–ª–æ–≤

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
*   –í–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
*   –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è 
*   Classification report

---
## 3. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö 
[–°–∫—Ä–∏–ø—Ç](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/classifier/inference.py) —è–≤–ª—è–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏, –ø–æ–∑–≤–æ–ª—è—è –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ü–µ–Ω–∏—Ç—å –æ–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏, –Ω–æ –∏ –∏–∑—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏.
–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:
1.  **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
    *   –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `HierarchicalBarcodeClassifier` –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.
    *   –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—É—Ç–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—à–∏–±–æ–∫.

2.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å**:
    *   –°–∫—Ä–∏–ø—Ç –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö (`test_loader`), –ø–æ–¥–∞–≤–∞—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –ø–æ–¥–∫–ª–∞—Å—Å–∞.
    *   –°–æ–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ –∏—Å—Ç–∏–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –æ–±–æ–∏—Ö —É—Ä–æ–≤–Ω–µ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏.
    *   **–°–±–æ—Ä –æ—à–∏–±–æ—á–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤**: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≥–¥–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ —Å–æ–≤–ø–∞–ª–æ —Å –∏—Å—Ç–∏–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π (–Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–ª–∏ –ø–æ–¥–∫–ª–∞—Å—Å–∞), —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ, –≤–∫–ª—é—á–∞—è –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –∏ –∏—Å—Ç–∏–Ω–Ω—ã–µ/–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã.

3.  **–†–∞—Å—á–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫**:
    *   –ù–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–æ–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –ø–æ–¥–∫–ª–∞—Å—Å–∞:
        *   –û–±—â–∏–µ: Accuracy, Precision (–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ), Recall (–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ), F1-score (–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ).
        *   –ü–æ–¥—Ä–æ–±–Ω—ã–π `classification_report` (–∏–∑ `sklearn.metrics`), –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π precision, recall, f1-score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞.
        *   –°–≤–æ–¥–∫–∞ –ø–æ –º–∞—Ç—Ä–∏—Ü–µ –æ—à–∏–±–æ–∫ (`confusion_matrix`), –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–≥–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞.
        *   –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –∏–∑ —Ä–∞–Ω–µ–µ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ—á–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.

4.  **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π**:
    *   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON-—Ñ–∞–π–ª.
    *   –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ–¥–∫–ª–∞—Å—Å, –∏—Å—Ç–∏–Ω–Ω—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∏ –∏—Å—Ç–∏–Ω–Ω—ã–π –ø–æ–¥–∫–ª–∞—Å—Å.

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
*   –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å `HierarchicalBarcodeClassifier` –∏ –µ—ë –≤–µ—Å–∞.
*   –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
*   –ü–∞–ø–∫–∞ —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π –≤ –≤–∏–¥–µ json —Ñ–∞–π–ª–æ–≤
*   `test_loader` (—ç–∫–∑–µ–º–ø–ª—è—Ä `torch.utils.data.DataLoader`) –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.


**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
*   –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.
*   JSON-—Ñ–∞–π–ª (`test_predictions_hard_to_detect.json`) —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–í–∏–¥ json —Ñ–∞–π–ª–∞ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏:
```
{
...
"Excise_stamp_0024.jpg": [
        {
            "main_class_pred": "2d",
            "sub_class_pred": "pdf",
            "main_class_true": "2d",
            "sub_class_true": "pdf"
        },
        {
            "main_class_pred": "2d",
            "sub_class_pred": "dm",
            "main_class_true": "2d",
            "sub_class_true": "dm"
        }
    ],
...
}
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ

### Main Class

| –ú–µ—Ç—Ä–∏–∫–∞     | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-------------|----------|
| Accuracy    | 0.7405   |
| Precision   | 0.9964   |
| Recall      | 0.7405   |
| F1 (avg)    | 0.8445   |

```text
--- Classification Report (Val - Main Class, —Å 'hard_to_detect') ---
              precision    recall  f1-score   support

             1d     0.99      0.88      0.93       369
             2d     1.00      0.65      0.79       547
```

```text
--- –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º (Main Class, —Å 'hard_to_detect') ---
  –ö–ª–∞—Å—Å '1d': –í—Å–µ–≥–æ 369.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 325 (88.08%)
  –ö–ª–∞—Å—Å '2d': –í—Å–µ–≥–æ 547.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 354 (64.72%)
```

### Sub Class

| –ú–µ—Ç—Ä–∏–∫–∞     | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-------------|----------|
| Accuracy    | 0.9542   |
| Precision   | 0.9592   |
| Recall      | 0.9542   |
| F1 (avg)    | 0.9531   |

```text
--- Classification Report (Val - Sub Class, —Å 'hard_to_detect') ---
              precision    recall  f1-score   support

            UPC     1.00      0.20      0.33        10
             az     1.00      1.00      1.00        23
           c128     0.97      0.84      0.90        83
            c39     0.78      0.89      0.83        28
             dm     0.97      1.00      0.98        59
          ean13     0.92      0.97      0.94       204
 hard_to_detect     0.95      0.97      0.96       237
            pdf     1.00      0.99      0.99       144
             qr     1.00      0.99      1.00       129
```

```text
--- –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º (Sub Class, —Å 'hard_to_detect') ---
  –ö–ª–∞—Å—Å 'UPC': –í—Å–µ–≥–æ 10.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 2 (20.00%)
  –ö–ª–∞—Å—Å 'az': –í—Å–µ–≥–æ 23.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 23 (100.00%)
  –ö–ª–∞—Å—Å 'c128': –í—Å–µ–≥–æ 83.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 70 (84.34%)
  –ö–ª–∞—Å—Å 'c39': –í—Å–µ–≥–æ 28.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 25 (89.29%)
  –ö–ª–∞—Å—Å 'dm': –í—Å–µ–≥–æ 59.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 59 (100.00%)
  –ö–ª–∞—Å—Å 'ean13': –í—Å–µ–≥–æ 204.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 197 (96.57%)
  –ö–ª–∞—Å—Å 'hard_to_detect': –í—Å–µ–≥–æ 237.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 229 (96.62%)
  –ö–ª–∞—Å—Å 'pdf': –í—Å–µ–≥–æ 144.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 142 (98.61%)
  –ö–ª–∞—Å—Å 'qr': –í—Å–µ–≥–æ 129.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 128 (99.22%)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ

### Main Class

| –ú–µ—Ç—Ä–∏–∫–∞     | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-------------|----------|
| Accuracy    | 0.71     |
| Precision   | 0.7650   |
| Recall      | 0.7099   |
| F1 (avg)    | 0.7081   |

```text
--- Classification Report (Test - Main Class, —Å 'hard_to_detect') ---
              precision    recall  f1-score   support

             1d     0.58      0.91      0.71       138
             2d     1.00      0.70      0.82       210
 hard_to_detect     0.25      0.16      0.19        45
```

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º:**
```text
--- –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º (Main Class, —Å 'hard_to_detect') ---
  –ö–ª–∞—Å—Å '1d': –í—Å–µ–≥–æ 138.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 126 (91.30%)
  –ö–ª–∞—Å—Å '2d': –í—Å–µ–≥–æ 210.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 146 (69.52%)
  –ö–ª–∞—Å—Å 'hard_to_detect': –í—Å–µ–≥–æ 45.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 7 (15.56%)
```

### Sub Class

| –ú–µ—Ç—Ä–∏–∫–∞     | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-------------|----------|
| Accuracy    | 0.64     |
| Precision   | 0.7888   |
| Recall      | 0.6438   |
| F1 (avg)    | 0.6833   |

```text
--- Classification Report (Test - Sub Class, —Å 'hard_to_detect') ---
              precision    recall  f1-score   support

             dm     0.88      0.43      0.58        88
          ean13     0.70      0.78      0.73       125
           ean8     1.00      0.08      0.14        13
 hard_to_detect     0.22      0.27      0.24        45
             qr     1.00      0.86      0.93       122
```

**–õ—É—á—à–∏–µ –∫–ª–∞—Å—Å—ã:**
```text
--- –°–≤–æ–¥–∫–∞ –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º (Sub Class, —Å 'hard_to_detect') ---
  –ö–ª–∞—Å—Å 'dm': –í—Å–µ–≥–æ 88.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 38 (43.18%)
  –ö–ª–∞—Å—Å 'ean13': –í—Å–µ–≥–æ 125.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 97 (77.60%)
  –ö–ª–∞—Å—Å 'ean8': –í—Å–µ–≥–æ 13.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 1 (7.69%)
  –ö–ª–∞—Å—Å 'hard_to_detect': –í—Å–µ–≥–æ 45.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 12 (26.67%)
  –ö–ª–∞—Å—Å 'qr': –í—Å–µ–≥–æ 122.0, –£–≥–∞–¥–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: 105 (86.07%)
```


**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
[1](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/data/datasets/our_parsed_dataset/images/ed06.jpg)
[2](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/data/datasets/our_parsed_dataset/images/IMG_20250402_020509.jpg)
[3](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/data/datasets/our_parsed_dataset/images/ed04.jpg)
[4](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/data/datasets/our_parsed_dataset/images/IMG_20250309_202603.jpg)
[5](https://github.com/dvpsun/mipt2025s-5-modern-cv/blob/main/data/datasets/our_parsed_dataset/images/ed51.jpg)
---


**–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –ø—É—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è:**

1.  **–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:**
    *   **–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π Val / Test:**
        *   –ï—Å–ª–∏ "Our Parsed" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ü–µ–ª–µ–≤–æ–π –¥–æ–º–µ–Ω, —Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª–µ–µ –ø–æ—Ö–æ–∂ –Ω–∞ –Ω–µ–≥–æ. –°—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞, –∫–∞–∫ —á–∞—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ.
    *   **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤:**
        *   –°–æ–±—Ä–∞—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–ª–∞—Å—Å–æ–≤ —Å –Ω–∏–∑–∫–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ ('ean8', 'dm', 'UPC').
        *   –î–æ–±–∞–≤–∏—Ç—å **—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤.
    *   **–£—Ç–æ—á–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ 'hard\_to\_detect':**
        *   –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —ç—Ç–æ—Ç –∫–ª–∞—Å—Å —Å–ª–∏—à–∫–æ–º –æ–±—â–∏–π. –ï–≥–æ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞–ø—Ä–∏–º–µ—Ä –Ω–∞ –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "—Å–ª–æ–∂–Ω—ã—Ö" —Å–ª—É—á–∞–µ–≤.
    *   **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤:**
        *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º:
            *   **Weighted Loss:** –ù–∞–∑–Ω–∞—á–∏—Ç—å –±–æ–ª—å—à–∏–µ –≤–µ—Å–∞ —Ä–µ–¥–∫–∏–º –∫–ª–∞—Å—Å–∞–º –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å.
            *   **Over/Undersampling:** –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞—Ä–∞—Å—Ç–∏—Ç—å –º–∏–Ω–æ—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å –º–∞–∂–æ—Ä–Ω—ã–µ.
            *   **Focal Loss:** –ú–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –∏ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–∞—Ö.

2.  **–£–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è:**
    *   **Fine-tuning ResNet50:**
        *   –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å **—Ä–∞–∑–º–æ—Ä–æ–∑–∏—Ç—å –±–æ–ª—å—à–µ —Å–ª–æ–µ–≤** –∏–ª–∏ –¥–∞–∂–µ –≤—Å—é —Å–µ—Ç—å (—Å –º–µ–Ω—å—à–∏–º learning rate –¥–ª—è –±–∞–∑–æ–≤—ã—Ö —Å–ª–æ–µ–≤) –¥–ª—è –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –∫ –∑–∞–¥–∞—á–µ.
    *   **–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
        *   –ü—Ä–æ–≤–µ—Å—Ç–∏ –±–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (learning rate, weight decay, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ AdamW).
        *   `ReduceLROnPlateau` —Å `patience=3` –º–æ–∂–µ—Ç —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ —Å–Ω–∏–∂–∞—Ç—å learning rate. –ú–æ–∂–Ω–æ –ø–æ—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `CosineAnnealingLR`).
    *   **Regularization:**
        *   –£—Å–∏–ª–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é (L2, dropout).
    *   **–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ vs. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:**
        *   –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç main –∏ sub –∫–ª–∞—Å—Å—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ú–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç, –≥–¥–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è main class, –∞ –∑–∞—Ç–µ–º, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è "–≥–æ–ª–æ–≤–∞" –¥–ª—è sub class (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–Ω–∞ –¥–ª—è 1D –∫–æ–¥–æ–≤, –¥—Ä—É–≥–∞—è –¥–ª—è 2D). –≠—Ç–æ —É—Å–ª–æ–∂–Ω–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –Ω–æ –º–æ–∂–µ—Ç –¥–∞—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç.

3.  **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
    *   **Cross-Validation:** –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å k-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è –±–æ–ª–µ–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏.

4.  **–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫:**
    *   –û–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å –ø–æ–¥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –¥–æ–º–µ–Ω. –ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –ø—Ä–æ–±–ª–µ–º—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ç–∞–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–Ω–æ–≥–æ –∫–æ–¥–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Å–Ω–∏–º–∫–µ, –∫–æ—Ç–æ—Ä—ã–µ —Å–Ω—è—Ç—ã –Ω–∞ –æ—Ç–¥–∞–ª–µ–Ω–∏–∏. –ï—Å–ª–∏ —Ü–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∫–æ–¥—ã, —Ç–æ –Ω–∞–¥–æ —Å–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –ø–æ–¥ —Ç–∞–∫–æ–π –¥–æ–º–µ–Ω –∏–ª–∏ –Ω–∞—Ä–∞—Å—Ç–∏—Ç—å –≤—ã–±–æ—Ä–∫—É —Å —Ç–∞–∫–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–ø–æ—Å–æ–±–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç–∞–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ú–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ (1d/2d), –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è:
- –£–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è hard_to_detect
- –ü–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è "—Å–ª–æ–∂–Ω—ã—Ö" –∫–æ–¥–æ–≤ (dm, ean8)
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤

–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–≥—É—Ç –ø–æ–≤—ã—Å–∏—Ç—å –æ–±—â—É—é accuracy –¥–æ 80-85% –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏.
